<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LWC Salesforce Classic</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="índice">Índice</h1>
<ol>
<li><a href="#ld-en-vf">Lightning Design en Visualforce</a></li>
<li><a href="#lwc-en-classic">LWC en Salesforce Classic</a></li>
<li><a href="#js-en-salesforce">Bibliotecas JS en Salesforce</a></li>
<li><a href="#implementacion-chartjs-en-vf">Implementación Chart.js en VF</a></li>
<li><a href="#documentacion">Documentación</a><br>
<a id="ld-en-vf"></a></li>
</ol>
<h1 id="lightning-design-en-visualforce">Lightning Design en Visualforce</h1>

<p><strong>Nota:</strong> ver Trailhead sobre <a href="https://trailhead.salesforce.com/content/learn/modules/lex_dev_visualforce">Visualforce y Lightning</a>, que cubre varios de estos temas<br>
<strong>Nota 2</strong>: off-topic, ver <a href="https://github.com/salesforce-ux/design-system-ui-kit">Lightning Design System + Sketch</a><br>
Asumiendo que solo queramos hacer páginas Visualforce, podemos <a href="https://www.lightningdesignsystem.com/platforms/visualforce/">incluir los estilos (guía oficial)</a> del <a href="https://www.lightningdesignsystem.com">Lightning Design System</a> a nuestras páginas, para obtener ese <em>look-and-feel</em> sin features extra de los sistemas front de SF más nuevos. Para hacerlo, en cualquier VF Page debemos agregar:</p>
<pre class=" language-html"><code class="prism  language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>page</span> <span class="token attr-name">lightningStyleSheets</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>slds</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>slds-scope<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token comment">&lt;!-- Contenido de la Page --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">apex:</span>page</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p>Esto nos añade dos posibilidades interesantes:</p>
<ol>
<li>Permite <strong>meter componentes Lightning dentro de una VF</strong>, como por ejemplo</li>
<li><strong>Lleva los viejos tags al nuevo look-and-feel</strong> sin tener que agregar código, por ejemplo <code>&lt;apex:inputField&gt;</code> o <code>&lt;apex:pageblock&gt;</code></li>
</ol>
<h4 id="controller-dinámico-en-visualforce">Controller dinámico en Visualforce</h4>
<p>Necesitamos interactuar con el <em>Apex controller</em> que define la VF Page. Para eso, si usamos Lightning Components, no podemos aprovechar el uso de <code>&lt;apex:...&gt;</code> con acciones estándar de llamada al controller. Además, los Component son dinámicos, así que deberíamos aprovechar eso con JavaScript (el dinamismo no es posible usando tags <code>&lt;apex:...&gt;</code>).<br>
Podemos ejecutar llamadas dinámicas a los controller con <a href="https://developer.salesforce.com/docs/atlas.en-us.pages.meta/pages/pages_js_remoting.htm">JS remoting</a>, lo cual puede resultar más o menos conveniente según el caso de uso (por lo general es preferible usar LWC en Classic).<br>
<a id="lwc-en-classic"></a></p>
<h1 id="lwc-en-salesforce-classic">LWC en Salesforce Classic</h1>

<p>Salesforce Classic utiliza <em>Visualforce</em> para mostrar las fichas dentro de las apps. Necesitamos llamar desde las Visualforce a Lightning Web Components que usen JavaScript, que tendrán gráficos “lindos”, conforme al requisito de Bayer.<br>
<strong>Nota</strong>: para mostrar gráficos pensé en usar <a href="https://www.chartjs.org/">chart.js</a>, pero si hay una solución  dentro de Salesforce (que sea “linda”), bienvenida.<br>
<strong>Disclaimer</strong>: otra alternativa es hacer uso de los informes y reportes de Salesforce Classic <s>o migrar a lightning</s>, pero no investigué acerca de eso.</p>
<h2 id="sobre-classic">Sobre Classic</h2>
<h4 id="crear-una-app">Crear una app</h4>
<p>Salesforce Classic se divide en ‘aplicaciones’, que no son más que un conjunto de fichas (predeterminadas y/o custom) que se muestran ante el usuario.<br>
Para comenzar, debemos crear una aplicación que contenga las fichas que crearemos. Entonces, dentro de Classic, vamos a</p>
<blockquote>
<p>Configuración &gt; Información general &gt; botón “Agregar aplicación”<br>
o bien,<br>
Configuración &gt; Compilación &gt; Crear &gt; Aplicaciones</p>
</blockquote>
<p>y elegimos un nombre para nuestro contenedor de fichas. Le agregaremos las fichas predeterminadas que queramos (luego irán agregadas las fichas custom).<br>
<strong>Nota</strong>: desde aquí se puede manejar la vista según el rol del usuario (permiso y predeterminada).</p>
<h4 id="crear-una-ficha">Crear una ficha</h4>
<p>Classic nos permite crear fichas custom, las cuales contienen una página Visualforce definida por nosotros. Para ello, vamos a</p>
<blockquote>
<p>Configuración &gt; Compilación &gt; Crear &gt; Fichas</p>
</blockquote>
<p>y elegimos una <em><strong>Visualforce page</strong></em> previamente subida desde el VS Code.<br>
Ahora solo nos queda llamar a un componente LWC desde Visualforce!</p>
<h2 id="cableado-entre-visualforce-y-lwc">Cableado entre Visualforce y LWC</h2>
<div class="mermaid"><svg xmlns="http://www.w3.org/2000/svg" id="mermaid-svg-FSsciP0q8A4LjjHn" width="100%" style="max-width: 508.140625px;" viewBox="0 0 508.140625 123"><g transform="translate(-12, -12)"><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M117.03378080985915,55.5L143.109375,43L168.109375,43" marker-end="url(#arrowhead82)" style="fill:none"></path><defs><marker id="arrowhead82" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M284.03125,43L337.8515625,43L391.671875,59.75179806836084" marker-end="url(#arrowhead83)" style="fill:none"></path><defs><marker id="arrowhead83" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M391.671875,97.24820193163916L337.8515625,114L226.0703125,114L143.109375,114L117.03378080985915,101.5" marker-end="url(#arrowhead84)" style="fill:none"></path><defs><marker id="arrowhead84" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(337.8515625,43)" style="opacity: 1;"><g transform="translate(-28.8203125,-13)" class="label"><foreignObject width="57.640625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">params?</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(226.0703125,114)" style="opacity: 1;"><g transform="translate(-18.2265625,-13)" class="label"><foreignObject width="36.453125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">cmp?</span></div></foreignObject></g></g></g><g class="nodes"><g class="node" id="A" transform="translate(69.0546875,78.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-49.0546875" y="-23" width="98.109375" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-39.0546875,-13)"><foreignObject width="78.109375" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Visualforce</div></foreignObject></g></g></g><g class="node" id="B" transform="translate(226.0703125,43)" style="opacity: 1;"><rect rx="5" ry="5" x="-57.9609375" y="-23" width="115.921875" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-47.9609375,-13)"><foreignObject width="95.921875" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Aura wrapper</div></foreignObject></g></g></g><g class="node" id="C" transform="translate(451.90625,78.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-60.234375" y="-23" width="120.46875" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-50.234375,-13)"><foreignObject width="100.46875" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">LWC o Aura c.</div></foreignObject></g></g></g></g></g></g></svg></div>
<hr>
<div class="mermaid"><svg xmlns="http://www.w3.org/2000/svg" id="mermaid-svg-7LHzaxmfjEfzmKMV" height="100%" width="100%" style="max-width:850px;" viewBox="-150 -10 850 382"><g></g><g><line id="actor6" x1="75" y1="5" x2="75" y2="371" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="0" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle;"><tspan x="75" dy="0">Visualforce</tspan></text></g><g><line id="actor7" x1="275" y1="5" x2="275" y2="371" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="200" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="275" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle;"><tspan x="275" dy="0">Aura wrapper</tspan></text></g><g><line id="actor8" x1="475" y1="5" x2="475" y2="371" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="400" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="475" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle;"><tspan x="475" dy="0">LWC o Aura c.</tspan></text></g><defs><marker id="arrowhead" refX="5" refY="2" markerWidth="6" markerHeight="4" orient="auto"><path d="M 0,0 V 4 L6,2 Z"></path></marker></defs><defs><marker id="crosshead" markerWidth="15" markerHeight="8" orient="auto" refX="16" refY="4"><path fill="black" stroke="#000000" stroke-width="1px" d="M 9,2 V 6 L16,4 Z" style="stroke-dasharray: 0, 0;"></path><path fill="none" stroke="#000000" stroke-width="1px" d="M 0,1 L 6,7 M 6,1 L 0,7" style="stroke-dasharray: 0, 0;"></path></marker></defs><g><text x="175" y="93" class="messageText" style="text-anchor: middle;">$Lightning.use</text><line x1="75" y1="100" x2="275" y2="100" class="messageLine1" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line></g><g><text x="375" y="128" class="messageText" style="text-anchor: middle;">$Lightning.createComponent</text><line x1="275" y1="135" x2="475" y2="135" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="500" y="145" fill="#EDF2AE" stroke="#666" width="150" height="48" rx="0" ry="0" class="note"></rect><text x="496" y="169" fill="black" class="noteText"><tspan x="516" fill="black">El LWC puede recibir</tspan></text><text x="496" y="183" fill="black" class="noteText"><tspan x="516" fill="black">params desde la VF.</tspan></text></g><g><text x="275" y="221" class="messageText" style="text-anchor: middle;">callback</text><line x1="475" y1="228" x2="75" y2="228" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" style="fill: none;"></line></g><g><rect x="-100" y="238" fill="#EDF2AE" stroke="#666" width="150" height="48" rx="0" ry="0" class="note"></rect><text x="-104" y="262" fill="black" class="noteText"><tspan x="-84" fill="black">callback puede usar</tspan></text><text x="-104" y="276" fill="black" class="noteText"><tspan x="-84" fill="black"> al cmp actual.</tspan></text></g><g><rect x="0" y="306" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="338.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle;"><tspan x="75" dy="0">Visualforce</tspan></text></g><g><rect x="200" y="306" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="275" y="338.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle;"><tspan x="275" dy="0">Aura wrapper</tspan></text></g><g><rect x="400" y="306" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="475" y="338.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle;"><tspan x="475" dy="0">LWC o Aura c.</tspan></text></g></svg></div>
<h4 id="visualforce">Visualforce</h4>
<p>Debemos crear una <em><strong>Visualforce Page</strong></em>, la cual debe tener la siguiente estructura:</p>
<pre class=" language-html"><code class="prism  language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>page</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>includeLightning</span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Soy una Visualforce<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lwcHere<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
	$Lightning<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">"c:LWCwrapper"</span><span class="token punctuation">,</span>  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
		$Lightning<span class="token punctuation">.</span><span class="token function">createComponent</span><span class="token punctuation">(</span><span class="token string">"c:simulacionLWC"</span><span class="token punctuation">,</span>
			<span class="token comment">// JSON con params, en este caso no se usan pero lo dejo a modo de ejemplo</span>
			<span class="token punctuation">{</span> label <span class="token punctuation">:</span>  <span class="token string">"Press Me!"</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token string">"lwcHere"</span><span class="token punctuation">,</span> <span class="token comment">// div id</span>
			<span class="token keyword">function</span><span class="token punctuation">(</span>cmp<span class="token punctuation">)</span>  <span class="token punctuation">{</span>
				<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"LWC was created"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token comment">// acciones al devolver LWC</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">apex:</span>page</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<ul>
<li><code>&lt;apex:includeLightning /&gt;</code> avisa que esta VF tiene comunicación con un LWC</li>
<li><code>&lt;div id="lwcHere" /&gt;</code> indica que el LWC debe renderizarse aquí. Dentro de <code>callback</code> se lo llama por este mismo id</li>
<li><code>$Lightning.use("c:LWCwrapper", callback)</code> tiene como primer argumento al <em><strong>Aura component</strong></em> que indica las dependencias LWC</li>
<li><code>$Lightning.createComponent</code> debe tener como primer argumento al nombre exacto del componente LWC
<ul>
<li>Si es un componente estándar, el nombre deberá ser <code>lightning:XXX</code></li>
<li>Si es un componente custom, el nombre deberá ser <code>c:XXX</code></li>
</ul>
</li>
<li>Observar que se pueden manejar params de input y acciones al devolver el LWC</li>
</ul>
<h4 id="aura-wrapper">Aura wrapper</h4>
<p>Debemos crear una <em><strong>Aura app</strong></em> que referencie las dependencias a los LWC:</p>
<pre class=" language-html"><code class="prism  language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aura:</span>application</span> <span class="token attr-name">access</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>global<span class="token punctuation">"</span></span> <span class="token attr-name">extends</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ltng:outApp<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aura:</span>dependency</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>c:simulacionLWC<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aura:</span>application</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<ul>
<li><code>resource</code> debe tener el nombre exacto del componente LWC a llamar en la VF</li>
</ul>
<h4 id="lwc-o-aura-c.">LWC o Aura C.</h4>
<p>Finalmente, se crea el <em><strong>Lightning Web Component</strong></em> o el <em><strong>Aura Component</strong></em> que tiene el comportamiento que nosotros queramos agregar.<br>
Para este caso, veamos un requisito:</p>
<blockquote>
<p>El vendedor debe introducir la cantidad de $ que vendió. Si vendió más de 500000, es “buen vendedor”. De lo contrario, es “mal vendedor”.<br>
La pantalla debe actualizarse dinámicamente y no deben hacerse llamadas al servidor (cálculos en el frontend).</p>
</blockquote>
<p>Aura Component</p>
<pre class=" language-html"><code class="prism  language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aura:</span>component</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aura:</span>attribute</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>amountSold<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Integer<span class="token punctuation">"</span></span> <span class="token attr-name">default</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>500000<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aura:</span>handler</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>change<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{!v.amountSold}<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{!c.setSellerRanking}<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aura:</span>attribute</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sellerRanking<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>String<span class="token punctuation">"</span></span> <span class="token attr-name">default</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>no determinada<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lightning:</span>layout</span> <span class="token attr-name">multipleRows</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">horizontalAlign</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lightning:</span>layoutItem</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>12<span class="token punctuation">"</span></span> <span class="token attr-name">padding</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>around-small<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lightning:</span>slider</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Cantidad vendida<span class="token punctuation">"</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1000000<span class="token punctuation">"</span></span> <span class="token attr-name">step</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1000<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>horizontal<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{!v.amountSold}<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">lightning:</span>layoutItem</span><span class="token punctuation">&gt;</span></span>
	
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lightning:</span>layoutItem</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span> <span class="token attr-name">padding</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>around-small<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lightning:</span>card</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Resultado<span class="token punctuation">"</span></span> <span class="token attr-name">iconName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utility:advanced_function<span class="token punctuation">"</span></span> <span class="token attr-name">variant</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>base<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>slds-card__body_inner<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>slds-text-align_center<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">1.5</span>rem<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>${!v.amountSold}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>slds-text-align_center<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">1</span>rem<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Calificación: {!v.sellerRanking}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">lightning:</span>card</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">lightning:</span>layoutItem</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">lightning:</span>layout</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aura:</span>component</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p>Aura Controller</p>
<pre class=" language-javascript"><code class="prism  language-javascript"><span class="token punctuation">(</span><span class="token punctuation">{</span>
    setSellerRanking <span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>component<span class="token punctuation">,</span> event<span class="token punctuation">,</span> helper<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> amount <span class="token operator">=</span> component<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'v.amountSold'</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> message <span class="token operator">=</span> <span class="token string">''</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>amount <span class="token operator">&lt;</span> <span class="token number">500000</span><span class="token punctuation">)</span>
            message <span class="token operator">=</span> <span class="token string">"mal vendedor"</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>amount <span class="token operator">&gt;=</span> <span class="token number">500000</span><span class="token punctuation">)</span>
            message <span class="token operator">=</span> <span class="token string">"buen vendedor"</span>
        component<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'v.sellerRanking'</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>Con esto logramos dinamismo en Salesforce Classic!<br>
<a id="js-en-salesforce"></a></p>
<h1 id="bibliotecas-javascript-en-visualforce">Bibliotecas JavaScript en Visualforce</h1>

<h4 id="motivación">Motivación</h4>
<p>Si bien usar LWC dentro de Visualforce parece ser lo más estético, el uso de LWC Out tiene limitaciones. Otra alternativa (para casos donde solo se requieran bibliotecas de JavaScript) es incluir scripts con la biblioteca en las <em><strong>Visualforce Pages</strong></em> sin tener que llamar a un LWC.<br>
Veamos un ejemplo con Chart.js. Para hacerlo, se necesita:</p>
<ol>
<li>Incluir Chart.js en un <code>.zip</code> como <a href="https://trailhead.salesforce.com/content/learn/modules/visualforce_fundamentals/visualforce_static_resources#add-zipped-static-resources-to-a-visualforce-page">recurso estático en la org.</a> que estemos usando</li>
<li>Hacer el siguiente código y llamar a Chart.js desde la Visualforce que hagamos (actualizado a Chart.js v2.9.3):</li>
</ol>
<pre class=" language-html"><code class="prism  language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>page</span> <span class="token attr-name">sidebar</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>includeScript</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{!URLFOR($Resource.Chartjs, <span class="token punctuation">'</span>Chart.bundle.js<span class="token punctuation">'</span>)}<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>chart-container<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span> <span class="token property">max-width</span><span class="token punctuation">:</span> <span class="token number">90</span>vw<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>canvas<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
	<span class="token keyword">var</span> ctx <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> myChart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chart</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">apex:</span>page</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<ul>
<li><code>&lt;apex:includeScript value="{!URLFOR($Resource.Chartjs, 'Chart.bundle.js')}"/&gt;</code> es el tag que incluye al zip estático
<ul>
<li>El primer argumento, <code>$Resource.XXX</code> llama al estático XXX por nombre</li>
<li>El segundo nombre indica el nombre del archivo <strong>dentro</strong> del <code>.zip</code> subido</li>
</ul>
</li>
<li>El resto del código del ejemplo es dependiente de la biblioteca</li>
</ul>
<h4 id="primera-aproximación-de-chart.js">Primera aproximación de Chart.js</h4>
<p><strong>Nota:</strong> para usar Chart.js en VF, ir directamente <a href="#implementacion-chartjs-en-vf">a la implementación</a><br>
Para dar un primer ejemplo, hagamos un pie chart que muestre la cantidad de <code>Case</code> por cada <code>Account</code>. Vamos a necesitar:<br>
<a id="controller-datos"></a></p>
<ol>
<li>Un controller custom en <em><strong>Apex</strong></em> que permita obtener los datos<br>
</li>
</ol>
<pre class=" language-java"><code class="prism  language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountCasesController</span> <span class="token punctuation">{</span>
    <span class="token comment">// state</span>
    <span class="token keyword">public</span> List<span class="token operator">&lt;</span>AccountWrapper<span class="token operator">&gt;</span> accountsWithNumberOfCases <span class="token punctuation">{</span>get<span class="token punctuation">;</span> <span class="token keyword">private</span> set<span class="token punctuation">;</span><span class="token punctuation">}</span>
    <span class="token comment">// constructor</span>
    <span class="token keyword">public</span> <span class="token function">AccountCasesController</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>accountsWithNumberOfCases <span class="token operator">==</span> null<span class="token punctuation">)</span>
            accountsWithNumberOfCases <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token operator">&lt;</span>AccountWrapper<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        List<span class="token operator">&lt;</span>AggregateResult<span class="token operator">&gt;</span> casesAndAccounts <span class="token operator">=</span> <span class="token punctuation">[</span>SELECT AccountId accId<span class="token punctuation">,</span> Account<span class="token punctuation">.</span>Name accName<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>Id<span class="token punctuation">)</span> amountOfCases
                                                 FROM Case
                                                 GROUP BY AccountId<span class="token punctuation">,</span> Account<span class="token punctuation">.</span>Name
                                                <span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>AggregateResult ar <span class="token operator">:</span> casesAndAccounts<span class="token punctuation">)</span>
            accountsWithNumberOfCases<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
                <span class="token keyword">new</span> <span class="token class-name">AccountWrapper</span><span class="token punctuation">(</span>
                    <span class="token punctuation">(</span>Id<span class="token punctuation">)</span> ar<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'accId'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token punctuation">(</span>String<span class="token punctuation">)</span> ar<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'accName'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token punctuation">(</span>Integer<span class="token punctuation">)</span> <span class="token punctuation">(</span>ar<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'amountOfCases'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null <span class="token operator">?</span> ar<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'amountOfCases'</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span>
                    <span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// json for visualforce</span>
        <span class="token keyword">public</span> String <span class="token function">getresultJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> JSON<span class="token punctuation">.</span><span class="token function">serialize</span><span class="token punctuation">(</span>accountsWithNumberOfCases<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token comment">// inner wrapper class</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountWrapper</span> <span class="token punctuation">{</span>
        <span class="token comment">// wrapper state</span>
        <span class="token keyword">public</span> Account acc <span class="token punctuation">{</span>get<span class="token punctuation">;</span> <span class="token keyword">private</span> set<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token keyword">public</span> Integer amountOfCases <span class="token punctuation">{</span>get<span class="token punctuation">;</span> <span class="token keyword">private</span> set<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token comment">// wrapper constructor</span>
        <span class="token keyword">public</span> <span class="token function">AccountWrapper</span><span class="token punctuation">(</span>Id accId<span class="token punctuation">,</span> String name<span class="token punctuation">,</span> Integer nCases<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            acc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Account</span><span class="token punctuation">(</span>Id <span class="token operator">=</span> accId<span class="token punctuation">,</span> Name <span class="token operator">=</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            amountOfCases <span class="token operator">=</span> nCases<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ol>
<li>Una <em><strong>Visualforce Page</strong></em> que use el controller</li>
</ol>
<pre class=" language-html"><code class="prism  language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>page</span> <span class="token attr-name">sidebar</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span> <span class="token attr-name">controller</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>AccountCasesController<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>includeScript</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{!URLFOR($Resource.Chartjs, <span class="token punctuation">'</span>Chart.bundle.js<span class="token punctuation">'</span>)}<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>chart-container<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span> <span class="token property">max-width</span><span class="token punctuation">:</span> <span class="token number">90</span>vw<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>canvas<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
		<span class="token keyword">const</span> accountList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token operator">&lt;</span>apex<span class="token punctuation">:</span>repeat value<span class="token operator">=</span><span class="token string">"{!accountsWithNumberOfCases}"</span> <span class="token keyword">var</span><span class="token operator">=</span><span class="token string">"wrapper"</span><span class="token operator">&gt;</span>
			accountList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>id<span class="token punctuation">:</span> <span class="token string">"{!wrapper.acc.Id}"</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">"{!wrapper.acc.Name}"</span><span class="token punctuation">,</span> amountOfCases<span class="token punctuation">:</span> <span class="token string">"{!wrapper.amountOfCases}"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>apex<span class="token punctuation">:</span>repeat<span class="token operator">&gt;</span>
		<span class="token keyword">const</span> ctx <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">const</span> colors <span class="token operator">=</span> <span class="token comment">// gigantic list of precalculated colors</span>
		<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
			datasets<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
			data<span class="token punctuation">:</span> accountList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>a <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span>amountOfCases<span class="token punctuation">)</span><span class="token punctuation">,</span>
			backgroundColor<span class="token punctuation">:</span> colors<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> accountList<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token comment">// get as much colors as needed</span>
		<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			labels<span class="token punctuation">:</span> accountList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>a <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">const</span> myPieChart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chart</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    	type<span class="token punctuation">:</span> <span class="token string">'pie'</span><span class="token punctuation">,</span>
    	data<span class="token punctuation">:</span> data<span class="token punctuation">,</span>
    	options<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
		
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">apex:</span>page</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p>Este ejemplo funciona al 100% en Salesforce Classic como una ficha en una aplicación.</p>
<h4 id="generalizando-en-un-componente">Generalizando en un componente</h4>
<p>El inconveniente del approach previo es que hay que ‘acomodar’ los datos a cada caso particular. El paso siguiente es generalizar los gráficos en un componente, para poder llamarlos desde fuera con un controller y una page. Para el caso de Chart.js, para los principales tipos de gráfico, los datos se estructuran así (vamos con un ejemplo tipo <a href="https://learnxinyminutes.com/docs/es-es/yaml-es/">YAML</a>):</p>
<ul>
<li>type: <strong>String</strong> <code>'pie'</code> <code>'doughnut'</code> <code>'line'</code> <code>'bar'</code></li>
<li>data: <strong>JSON</strong>
<ul>
<li>labels: <strong><em>array</em> String</strong> <code>["Africa", "Asia", "Europe", "Latin America", "North America"]</code></li>
<li>datasets: <strong><em>array</em> JSON</strong>
<ul>
<li>label: <strong>String</strong> <code>'Population (millions)'</code></li>
<li>data: <strong><em>array</em> Number</strong> <code>[2478,5267,734,784,433]</code></li>
<li>backgroundColor: <strong><em>array</em> color String</strong> <code>["#3e95cd", ...]</code>, o <code>['rgba(99,181,152, 0.7)', ...]</code></li>
</ul>
</li>
</ul>
</li>
<li>options: <strong>JSON</strong><br>
Sabiendo esto, lo mejor sería crear un componente VF que permita manejar cualquier tipo de gráfico. Si bien Chart.js intenta <a href="https://www.chartjs.org/docs/latest/configuration/">estandarizar su API</a>, es necesario hacer algunos defaults por tipo de gráfico para cubrir todas las posibilidades que el usuario pueda llamar.<br>
Por ejemplo, para ocultar un label extra en los gráficos de barra, es necesario llamar a <code>Chart.defaults.bar.legend = { display: false };</code>. Ahondando un poco más, en algunos tipos de gráfico los datos se presentan de forma distinta (ver <code>pie</code> vs. <code>line</code>), por lo que quizás sea mejor separar en componentes, agrupando según cómo definan el JSON del tipo.<br>
<a id="implementacion-chartjs-en-vf"></a></li>
</ul>
<h1 id="implementación-chart.js-en-vf">Implementación Chart.js en VF</h1>

<h4 id="gráficos-de-1-un-dataset">Gráficos de 1 (un) dataset</h4>
<div class="mermaid"><svg xmlns="http://www.w3.org/2000/svg" id="mermaid-svg-dINKmxffYmoj31yc" width="100%" style="max-width: 623.796875px;" viewBox="0 0 623.796875 88"><g transform="translate(-12, -12)"><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M139.40625,47.80769051503146L247.3203125,33L355.234375,43.164091243561444" marker-end="url(#arrowhead95)" style="fill:none"></path><defs><marker id="arrowhead95" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M355.234375,68.83590875643856L247.3203125,79L139.40625,64.19230948496853" marker-end="url(#arrowhead96)" style="fill:none"></path><defs><marker id="arrowhead96" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(247.3203125,33)" style="opacity: 1;"><g transform="translate(-25.5234375,-13)" class="label"><foreignObject width="51.046875" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Params</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(247.3203125,79)" style="opacity: 1;"><g transform="translate(-82.9140625,-13)" class="label"><foreignObject width="165.828125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">onDOMContentLoaded</span></div></foreignObject></g></g></g><g class="nodes"><g class="node" id="A" transform="translate(79.703125,56)" style="opacity: 1;"><rect rx="0" ry="0" x="-59.703125" y="-23" width="119.40625" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-49.703125,-13)"><foreignObject width="99.40625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Ficha VF Page</div></foreignObject></g></g></g><g class="node" id="B" transform="translate(491.515625,56)" style="opacity: 1;"><rect rx="0" ry="0" x="-136.28125" y="-23" width="272.5625" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-126.28125,-13)"><foreignObject width="252.5625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">barAndRoundCharts VF Component</div></foreignObject></g></g></g></g></g></g></svg></div>
<p>Params: <code>title</code> <code>chartType</code> <code>allData</code> <code>width</code> <code>dataAccessors</code> <code>labelAccessors</code></p>
<ul>
<li><strong>VF Page</strong>: llama al componente de charts</li>
</ul>
<pre class=" language-html"><code class="prism  language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>page</span> <span class="token attr-name">sidebar</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span> <span class="token attr-name">controller</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>AccountCasesController<span class="token punctuation">"</span></span> <span class="token attr-name">lightningStylesheets</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>slds</span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>slds-grid slds-gutters<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>slds-col<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>	  
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">c:</span>barAndRoundCharts</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>Amount of cases per account1<span class="token punctuation">'</span></span> <span class="token attr-name">chartType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>pie<span class="token punctuation">'</span></span> <span class="token attr-name">allData</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>{!resultJson}<span class="token punctuation">'</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>30<span class="token punctuation">'</span></span> <span class="token attr-name">dataAccessors</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>amountOfCases<span class="token punctuation">'</span></span> <span class="token attr-name">labelAccessors</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>acc.Name<span class="token punctuation">'</span></span> <span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>slds-col<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">c:</span>barAndRoundCharts</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>Amount of cases per account2<span class="token punctuation">'</span></span> <span class="token attr-name">chartType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>doughnut<span class="token punctuation">'</span></span> <span class="token attr-name">allData</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>{!resultJson}<span class="token punctuation">'</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>30<span class="token punctuation">'</span></span> <span class="token attr-name">dataAccessors</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>amountOfCases<span class="token punctuation">'</span></span> <span class="token attr-name">labelAccessors</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>acc.Name<span class="token punctuation">'</span></span> <span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>slds-col<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>	  
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">c:</span>barAndRoundCharts</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>Amount of cases per account3<span class="token punctuation">'</span></span> <span class="token attr-name">chartType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>bar<span class="token punctuation">'</span></span> <span class="token attr-name">allData</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>{!resultJson}<span class="token punctuation">'</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>30<span class="token punctuation">'</span></span> <span class="token attr-name">dataAccessors</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>amountOfCases<span class="token punctuation">'</span></span> <span class="token attr-name">labelAccessors</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>acc.Name<span class="token punctuation">'</span></span> <span class="token attr-name">generalLabel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>Amount of cases<span class="token punctuation">'</span></span> <span class="token punctuation">/&gt;</span></span>				
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>slds-grid slds-gutters<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>slds-col<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>	  
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">c:</span>barAndRoundCharts</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>Amount of cases per account4<span class="token punctuation">'</span></span> <span class="token attr-name">chartType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>horizontalBar<span class="token punctuation">'</span></span> <span class="token attr-name">allData</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>{!resultJson}<span class="token punctuation">'</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>30<span class="token punctuation">'</span></span> <span class="token attr-name">dataAccessors</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>amountOfCases<span class="token punctuation">'</span></span> <span class="token attr-name">labelAccessors</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>acc.Name<span class="token punctuation">'</span></span> <span class="token attr-name">generalLabel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>Amount of cases<span class="token punctuation">'</span></span> <span class="token punctuation">/&gt;</span></span>				
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>slds-col<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>	  
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">c:</span>barAndRoundCharts</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>Amount of cases per account5<span class="token punctuation">'</span></span> <span class="token attr-name">chartType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>polarArea<span class="token punctuation">'</span></span> <span class="token attr-name">allData</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>{!resultJson}<span class="token punctuation">'</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>30<span class="token punctuation">'</span></span> <span class="token attr-name">dataAccessors</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>amountOfCases<span class="token punctuation">'</span></span> <span class="token attr-name">labelAccessors</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>acc.Name<span class="token punctuation">'</span></span> <span class="token attr-name">generalLabel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>Amount of cases<span class="token punctuation">'</span></span> <span class="token punctuation">/&gt;</span></span>				
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">apex:</span>page</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<ul>
<li><strong>VF Component</strong>: tiene la lógica del chart</li>
</ul>
<pre class=" language-html"><code class="prism  language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>component</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>includeScript</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{!URLFOR($Resource.Chartjs, <span class="token punctuation">'</span>Chart.bundle.js<span class="token punctuation">'</span>)}<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>attribute</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">"</span></span> <span class="token attr-name">description</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>% of the viewport<span class="token punctuation">'</span>s width this component takes<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Integer<span class="token punctuation">"</span></span> <span class="token attr-name">default</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>90<span class="token punctuation">'</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>attribute</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>chartType<span class="token punctuation">"</span></span> <span class="token attr-name">description</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Chart.js chart type<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>String<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>attribute</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>allData<span class="token punctuation">"</span></span> <span class="token attr-name">description</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>passed data<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>String<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>attribute</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span> <span class="token attr-name">description</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Chart title<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>String<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>attribute</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>labelAccessors<span class="token punctuation">"</span></span> <span class="token attr-name">description</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{a: 1} =&gt; pass <span class="token punctuation">'</span>a<span class="token punctuation">'</span>; {a:{b: 1}} =&gt; pass <span class="token punctuation">'</span>a.b<span class="token punctuation">'</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>String<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>attribute</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dataAccessors<span class="token punctuation">"</span></span> <span class="token attr-name">description</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{a: 1} =&gt; pass <span class="token punctuation">'</span>a<span class="token punctuation">'</span>; {a:{b: 1}} =&gt; pass <span class="token punctuation">'</span>a.b<span class="token punctuation">'</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>String<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">apex:</span>attribute</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>generalLabel<span class="token punctuation">"</span></span> <span class="token attr-name">description</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Tooltip label for each element in chart<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>String<span class="token punctuation">"</span></span> <span class="token attr-name">default</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>chart-container<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token selector">position: relative; max-width: </span><span class="token punctuation">{</span>!width<span class="token punctuation">}</span>vw<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{!title}<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token punctuation">{</span>		<span class="token keyword">const</span> colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'rgba(99,181,152,0.7)'</span><span class="token punctuation">,</span><span class="token string">'rgba(206,125,120,0.7)'</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">]</span> <span class="token comment">// +500 hardcoded colors</span>
		<span class="token keyword">const</span> <span class="token function-variable function">accessData</span> <span class="token operator">=</span> <span class="token punctuation">(</span>object<span class="token punctuation">,</span> accessors<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token keyword">let</span> accessorArray <span class="token operator">=</span> accessors<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span> accessorArray<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>acum<span class="token punctuation">,</span> cur<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> acum<span class="token punctuation">[</span>cur<span class="token punctuation">]</span><span class="token punctuation">,</span> object<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"DOMContentLoaded"</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token comment">// parameter parsing</span>
		<span class="token keyword">const</span> title <span class="token operator">=</span> <span class="token string">'{!title}'</span>
		<span class="token keyword">const</span> cType <span class="token operator">=</span> <span class="token string">'{!chartType}'</span>
		<span class="token keyword">const</span> dAccessors <span class="token operator">=</span> <span class="token string">'{!dataAccessors}'</span>
		<span class="token keyword">const</span> lAccessors <span class="token operator">=</span> <span class="token string">'{!labelAccessors}'</span>
		<span class="token keyword">const</span> initialData <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">!</span>allData<span class="token punctuation">}</span>
		<span class="token keyword">const</span> ctx <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
		labels<span class="token punctuation">:</span> initialData<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>a <span class="token operator">=&gt;</span> <span class="token function">accessData</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> lAccessors<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		datasets<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
			label<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token operator">!</span>generalLabel<span class="token punctuation">}</span><span class="token punctuation">,</span>
			data<span class="token punctuation">:</span> initialData<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>a <span class="token operator">=&gt;</span> <span class="token function">accessData</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> dAccessors<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			backgroundColor<span class="token punctuation">:</span> colors<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> initialData<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">]</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// global chart defaults by type</span>
		Chart<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>bar<span class="token punctuation">.</span>legend <span class="token operator">=</span> <span class="token punctuation">{</span> display<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// dont display unnecessary labels for bar chart</span>
		Chart<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>horizontalBar<span class="token punctuation">.</span>legend <span class="token operator">=</span> <span class="token punctuation">{</span> display<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// dont display unnecessary labels for bar chart</span>
		Chart<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>scale<span class="token punctuation">.</span>ticks<span class="token punctuation">.</span>beginAtZero <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token comment">// start number axis at 0</span>
		<span class="token comment">// chart creation</span>
		<span class="token keyword">new</span> <span class="token class-name">Chart</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    	type<span class="token punctuation">:</span> cType<span class="token punctuation">,</span>
    	data<span class="token punctuation">:</span> data<span class="token punctuation">,</span>
    	options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
			title<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        		display<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        		text<span class="token punctuation">:</span> title
      		<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>	</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">apex:</span>component</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<ul>
<li><strong>Apex controller</strong>: <a href="#controller-datos">ídem anterior</a> en esta implementación, pero puede usarse cualquier otro set de datos<br>
<a id="documentacion"></a></li>
</ul>
<h2 id="documentación">Documentación</h2>

<ul>
<li>LWC + Visualforce
<ul>
<li><strong><a href="https://trailhead.salesforce.com/content/learn/modules/lex_dev_visualforce/lex_dev_visualforce_known_issues">Limitaciones conocidas</a></strong></li>
<li><a href="https://developer.salesforce.com/docs/component-library/documentation/en/lwc/lwc.get_started_introduction">LWC guide</a></li>
<li><a href="https://www.lightningdesignsystem.com/platforms/visualforce/">LWC in Visualforce, no Aura</a></li>
<li><a href="https://releasenotes.docs.salesforce.com/en-us/summer20/release-notes/rn_lc_message_channel.htm?edition=&amp;impact=">LWC message channel (de aplicación)</a></li>
<li><a href="https://developer.salesforce.com/docs/atlas.en-us.pages.meta/pages/pages_js_remoting.htm">JavaScript remoting, dynamic Apex controllers</a></li>
<li><a href="https://www.lightningdesignsystem.com/guidelines/charts/">Charts de LWC</a></li>
</ul>
</li>
<li>LWC out
<ul>
<li><strong><a href="https://developer.salesforce.com/docs/component-library/documentation/lwc/lightning_out_considerations.html">Limitaciones y consideraciones</a></strong></li>
<li><strong><a href="https://blog.internetcreations.com/2020/01/developer-tips-for-building-salesforce-lightning-web-components/">Limitaciones, cont.</a></strong></li>
<li><a href="https://releasenotes.docs.salesforce.com/en-us/summer19/release-notes/rn_lwc_vf.htm">Statement oficial VF-LWC (Summer '19)</a></li>
<li><a href="https://developer.salesforce.com/docs/component-library/documentation/en/lwc/lwc.lightning_out">Documentación oficial LWC out</a></li>
<li><a href="https://developer.salesforce.com/docs/atlas.en-us.lightning.meta/lightning/lightning_out_markup.htm#lightning_out_markup">Sobre Lightning.use y Lightning.createComponent</a></li>
</ul>
</li>
<li>Ejemplos
<ul>
<li><a href="https://developer.salesforce.com/docs/atlas.en-us.pages.meta/pages/pages_flows_lightningruntime.htm">Ejemplo oficial</a></li>
<li><a href="https://www.paul-force.com/2019/04/24/use-lightning-web-components-in-visualforce-pages/">Use LWC in VF pages</a></li>
<li><a href="https://developer.salesforce.com/forums/?id=906F00000005I8mIAE">Problem with LWC in Visualforce</a></li>
</ul>
</li>
<li>Chart.js
<ul>
<li><a href="https://medium.com/@ishaarora_49656/add-dynamic-data-to-chart-in-lwc-9d88e8b4516e">LWC + Chart.js</a></li>
<li><a href="https://www.forcetrails.com/2019/10/using-chartjs-in-lightning-web.html">LWC + Chart.js + D3</a></li>
<li><a href="https://www.forcetrails.com/2020/04/bar-chart-in-lightning-web-component-lwc-bar-chartjs.html">Bar chart in LWC using Chart.js</a></li>
</ul>
</li>
<li>Visualforce
<ul>
<li><a href="https://trailhead.salesforce.com/content/learn/modules/visualforce_fundamentals/visualforce_static_resources#add-zipped-static-resources-to-a-visualforce-page">Add a static resource</a></li>
</ul>
</li>
<li>Diseño
<ul>
<li><a href="https://github.com/salesforce-ux/design-system-ui-kit">Lightning + Sketch</a></li>
<li><a href="https://www.avonni.app/">Avonni Creator</a></li>
</ul>
</li>
</ul>
</div>
</body>

</html>
